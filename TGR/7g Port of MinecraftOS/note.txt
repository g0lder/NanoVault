Ported from Omspeare's for the 6g
